<!DOCTYPE html>
<!-- saved from url=(0045)https://course.cse.ust.hk/comp2211/labs/lab8/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

	<!-- ### Change lab number ### -->
    <title>COMP 2211 Lab 8: Convolutional Neural Networks</title>

   <!-- Bootstrap core CSS -->
  <link href="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/blog-home.css" rel="stylesheet">

  <!-- For code highlighting -->
  <link href="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/prism.css" rel="stylesheet">

  <style>
    pre {
      background: #f4f4f4;
      border: 1px solid #ddd;
      border-left: 3px solid #f36d33;
      color: #666;
      page-break-inside: avoid;
      font-family: monospace;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 1.6em;
      max-width: 100%;
      overflow: auto;
      padding: 1em 1.5em;
      display: block;
      word-wrap: break-word;
    }

    span.input {
      color: #00f700;
      ;
    }

    /* table {
      width: 100%;
      display: inline-block;
      overflow-x: auto;
    }

    table caption {
      font-size: medium;
    }

    table thead th {
      background-color: #ddd;
    }

    table th,
    table td {
      text-align: left;
      padding: 3px 6px;
      border-width: 1px;
      border-style: solid;
      border-color: #aaa #aaa;
    }

    table tr:nth-child(even) {
      background-color: #eee;
    } */

    blockquote {
      border: 1px solid #b3b3b3;
      border-left: 10px solid #b3b3b3;
      border-radius: 0px;
      background: #fafafa;
      font-size: 18px;
      font-family: Georgia, serif;
      margin: 10px;
      padding: 10px 20px;
    }

    blockquote p {
      margin: 0;
      line-height: 30px;
      padding-bottom: 20px;
    }

    blockquote.small {
      display: block;
      font-size: 80%;
      color: brown;
      text-align: right;
    }

    code {
      /* color: goldenrod; */
      font-size: 1em;
      /* background: none !important; */
    }

    figure.figure {
      width: 100%;
      text-align: center;
    }

    .bd-callout {
      padding: 1.25rem;
      margin-top: 1.25rem;
      margin-bottom: 1.25rem;
      border: 1px solid #eee;
      border-left-width: .25rem;
      border-radius: .25rem;
    }

    .bd-callout h4 {
      margin-top: 0;
      margin-bottom: .25rem;
    }

    .bd-callout p:last-child {
      margin-bottom: 0;
    }

    .bd-callout code {
      border-radius: .25rem;
    }

    .bd-callout+.bd-callout {
      margin-top: -.25rem;
    }

    .bd-callout-info {
      border-left-color: #5bc0de;
    }

    .bd-callout-warning {
      border-left-color: #f0ad4e;
    }

    .bd-callout-danger {
      border-left-color: #d9534f;
    }

    .bd-callout-success {
      border-left-color: #5cb85c;
    }

    .bd-callout-primary {
      border-left-color: #428bca;
    }

    .bd-callout-info h6 {
      color: #5bc0de;
    }

    .bd-callout-warning h6 {
      color: #f0ad4e;
    }

    .bd-callout-danger h6 {
      color: #d9534f;
    }

    .bd-callout-success h6 {
      color: #5cb85c;
    }

    .bd-callout-primary h6 {
      color: #428bca;
    }
  </style>
  </head>

  <body>
  <script src="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/prism.js.download"></script>
  <!--     <script src="https://myCDN.com/prism@v1.x/components/prism-core.min.js"></script>
    <script src="https://myCDN.com/prism@v1.x/plugins/autoloader/prism-autoloader.min.js"></script> -->
	
    <!-- Page Content -->	
    <div class="container">

      <div class="row">

        <!-- Entries Column -->
        <div class="col-md-9">

          <h2 class="my-4"><span style="color:darkblue">COMP 2211</span>
            <small>Exploring Artificial Intelligence</small>
          </h2>
		  
		  <!-- ### Change lab number and title ### -->
		  <h3 class="my-4">Lab 8
            <span style="color:#660066">Convolutional Neural Networks</span>
          </h3>
		  
		  <!-- Review section -->
		  <!-- ### Complete the review section for the lab ### -->
          <div class="card mb-4">      
            <div class="card-body" id="review">
              <h3 class="card-title">Review</h3>
              <p class="card-text">
                This is a review of Image Classification and Convolutional Neural Network (CNN). It aims to refresh your memory of what you have learned in class.<br><br>

                </p><h4>The procedure of training a CNN for image classification:</h4>
                <ol>
                  <li>Import required libraries and define global variables</li>
                  <li>Data preprocessing</li>
                  <li>Build the model</li>
                  <li>Compile the model</li>
                  <li>Train the model</li>
                  <li>Evaluate the model</li>
                  <li>Save the model</li>
                </ol><br>

                Please download the <a download="" href="https://course.cse.ust.hk/comp2211/labs/lab8/files/lab8_review.ipynb">review notebook</a>, upload it to your Google Colab.
                You should see the following if you open the notebook successfully.
                <br><br>
                <img style="width:100%" src="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/review.png">
              <p></p>
            </div>
			<div class="card-footer text-muted">
              End of Review
            </div>
          </div>

          <!-- Introduction section -->
		  <!-- ### Complete introduction section for the lab ### -->
          <div class="card mb-4">
		  
		    <!-- ### Add an image representing the lab content here ### -->
            <img class="card-img-top" src="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/intro.png" alt="Card image cap">    

            <div class="card-body" id="introduction">
              <h3 class="card-title">Introduction</h3>
              <p class="card-text">
              </p>
              Image classification is a popular task of assigning a class label to a given image, which has been applied to various domains such as face recognition and medical image analysis.
              <br><br>
              In this lab, you will practice your CNN skills by conducting the image classification task based on the <a href="https://www.kaggle.com/datasets/anirudhcv/labeled-optical-coherence-tomography-oct/data">Retinal OCT Images Dataset</a>. 
              This dataset was originally presented by <a href="https://www.cell.com/cell/fulltext/S0092-8674(18)30154-5">Kermany <i>et al.</i> in  <i>Cell</i> in 2018.</a>
              <br><br>
              Briefly, optical coherence tomography (OCT) images of the retina can be used for screening of patients with common treatable blinding retinal diseases.
              The datasets consists of patients with choroidal neovascularization (<b>CNV</b>), diabetic macular edema (<b>DME</b>), drusen (<b>DRUSEN</b>), and also, normal (<b>NORMAL</b>) patients without any of the diseases above.
              The original dataset presented contain around 100,000 images. Due to restriction of resources (you will <b>NOT</b> be required to pay for Colab Pro), we only select 900 images for the purpose of training.
              Therefore, although the original article reported very high accuracy (around 0.95), it is expected that the model trained on such a small fraction (less than 1%) of total data will have worse performance.
              Also, the original article utilized some more advanced techniques which are beyond the scope of this course. If you are interested, you may read the original article and find out about their methods.
              However, such exploration is <b>NOT</b> required and is <b>NOT</b> related to the tasks in this lab.
            </div>
                <div class="card-footer text-muted">
                  End of Introduction
                </div>
              </div>

              <!-- Lab work section -->
		  <!-- ### Complete the lab work section for the lab ### -->
          <div class="card mb-4">      
            <div class="card-body" id="labwork">
              <h3 class="card-title">Lab Work</h3>
			  <br>
        To train a model that can successfully classify different OCT images, you will need to complete <b>three tasks</b>, involving loading training data (task 1), train-test split (task 2), and CNN model building (task 3). 
	      Before begining, you need to follow the below steps for preparation:<br>
        1. Please download the <a download="" href="https://course.cse.ust.hk/comp2211/labs/lab8/files/lab8_task.ipynb">notebook</a>, and open this notebook on Google Colab. <br>
        2. Download the  <a download="" href="https://course.cse.ust.hk/comp2211/labs/lab8/files/lab8_Fall2025_train.zip">dataset</a>.<br>
        3. Upload the zip file (do NOT unzip it) to your Google Drive, under folder `<font color="red">comp2211/lab8</font>` as shown in the following image: 
        <img class="card-img-top" src="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/data_uploading.png" alt="How to upload files">           
                
        <br><br>
        For the first two tasks, you will be graded on outputs of your function. For the third task, you will be graded on your model's performance on a <b>hidden test case</b>. Note that this test case does <b>NOT </b> overlap with the data provided before the deadline and will <b>NOT</b> be released until the grading has finished.
        <br><br>
        If you would like to do further exploration on the data and model, please do so inside
        if __name__ == "__main__". NEVER add any additional print statement (or equivalent) outside if __name__ == "__main__". 
        Otherwise you may NOT be able to pass test cases in ZINC.
        <br><br>

        
        <b>Test cases for this lab</b>: <br> 
        <ul>
            <li><b>Test # 1: </b> function load_dataset (3 pts)</li>
            <li><b>Test # 2: </b> function train_test_split (1 pts)</li>
            <li><b>Test # 3: </b> above 0.30 accuracy on hidden test case (2 pts)</li>
            <li><b>Test # 4: </b> above 0.50 accuracy on hidden test case (2 pts)</li>
            <li><b>Test # 5: </b> above 0.65 accuracy on hidden test case (2 pts)</li>
        </ul>


        <br>
            </div>
			<div class="card-footer text-muted">
              End of Lab Work
            </div>
          </div>

          <!-- Resources section -->
		  <!-- ### Complete resources section for the lab ### -->
          <!-- <div class="card mb-4">            
            <div class="card-body" id="resources">
              <h3 class="card-title">Resources &amp; Sample I/O</h3>
			  <ul>
			    <li>Skeleton code: <a href="">...</a></li>
				<li>Demo program (executable for Windows): <a href="">...</a></li>
			  </ul>
              <h4>Sample I/O</h4>
            </div>            
			<div class="card-footer text-muted">
              End of Resources &amp; Sample I/O
            </div>
          </div> -->
		  
		  <!-- Grading scheme section -->
		  <!-- ### Complete grading section for the lab ### -->
          <div class="card mb-4">            
            <div class="card-body" id="grading">
              <h3 class="card-title">Submission &amp; Grading</h3> 
        <ul>
          <li>Deadline: <font color="#f00">1, Dec., 2025, 23:59.</font></li>
          <li>You may earn 10 points for this lab via Automated Grading on the <a href="https://zinc.cse.ust.hk/">ZINC Online Submission System</a>. See the grading scheme as above.</li>
          <li>Save your Python Notebook as a <code>lab8_task.py</code> file from Google Colab by clicking File -&gt; Download -&gt; Download .py.</li>
          <li>Download your trained model <code>model_lab8.keras</code>.</li>
          <li><b>Zip the completed <code>lab8_task.py</code> and your trained model <code>model_lab8.keras</code> as <code>lab8_task.zip</code> for submission to ZINC. Zip the two files directly, DO NOT put them in a folder.</b></li>
          <li>You may submit your file multiple times (&lt;= 50 submissions), but only the latest version will be graded.</li>
          <li>Lab work submitted via channels other than ZINC will <font color="red">NOT</font> be accepted. Late submissions will <font color="red">NOT</font> be accepted either.</li>
        </ul>
            </div>
			<div class="card-footer text-muted">
              End of Submission &amp; Grading
            </div>
          </div>
		  
                  <!-- Frequently asked questions section -->
                  <!-- ### Complete frequently asked questions section for the lab ### -->
          <div class="card mb-4">
            <!--<img class="card-img-top" src="a6e.jpg" alt="Card image cap">-->
            <div class="card-body" id="faq">
              <h3 class="card-title">Frequently Asked Questions</h3>
              <ul>
                
              </ul>
                          <!-- <p class="card-text">This list is incomplete. You can always help by <a href="mailto:zxiebb@connect.ust.hk"><u>expanding it</u>.</a> -->
                          <p class="card-text">None
            </p></div>
                  	<div class="card-footer text-muted">
              End of Frequently Asked Questions. Don't hesitate to ask ;)
            </div>
          </div>
        </div>
        <!-- Sidebar Widgets Column -->
        <div class="col-md-3">
		  <div class="sticky-top">
            <!-- Menu Widget -->
            <div class="card my-12">
              <h5 class="card-header">Menu</h5>
              <div class="card-body">
                <div class="row">
                  <div class="col-lg-12">
                    <ul class="mb-0" type="circle" style="padding-left:20px">
					  <li>
                        <a href="https://course.cse.ust.hk/comp2211/labs/lab8/#review">Review</a>
                      </li>
                      <li>
                        <a href="https://course.cse.ust.hk/comp2211/labs/lab8/#introduction">Introduction</a>
                      </li>
                      <li>
                        <a href="https://course.cse.ust.hk/comp2211/labs/lab8/#labwork">Lab Work</a>
                      </li>
                      <!-- <li>
                        <a href="#resources">Resources &amp; Sample I/O</a>
                      </li> -->
			  		  <li>
				  	    <a href="https://course.cse.ust.hk/comp2211/labs/lab8/#grading">Submission &amp; Grading</a>
					  </li>
					  <li>
						<a href="https://course.cse.ust.hk/comp2211/labs/lab8/#faq">Frequently Asked Questions</a>
					  </li>
                    </ul>
                  </div>                
                </div>
              </div>
		    </div>
          		  
		    <!-- Maintainance widget -->
            <div class="card my-4">
              <h5 class="card-header">Page maintained by</h5>
              <div class="card-body">
                <div class="row">
                  <div class="col-lg-12">
                    <ul class="list-unstyled mb-0">
                      <li>
                        Zhaoyang LIU
                      </li>
                      <li>
                        Email: <a href="mailto:zliufj@connect.ust.hk">zliufj@connect.ust.hk</a>
                      </li>
                      <li>
                        Lab Task Designer: Zequan Xie
                      </li>
					  <li>Last Modified: <script type="text/javascript">document.write(document.lastModified);</script>11/13/2025 17:37:59</li>
                    </ul>
                  </div>				
                </div>
              </div>
			</div>          
		  		  
		    <!-- Homepage widget -->
            <div class="card my-4">
              <h5 class="card-header">Homepage</h5>
              <div class="card-body">
                <div class="row">
                  <div class="col-lg-12">
                    <ul class="list-unstyled mb-0">
                      <li>
                        <a href="http://course.cse.ust.hk/comp2211">Course Homepage</a>
                      </li>
                    </ul>
                  </div>				
                </div>
              </div>
            </div>
	      </div>
        </div>
      </div>
      <!-- /.row -->

    </div>
    <!-- /.container -->

    <!-- Footer -->
    <footer class="py-5 bg-dark">
      <div class="container">
        <p class="m-0 text-center text-white">Maintained by COMP 2211 Teaching Team Â© 2025 HKUST Computer Science and Engineering</p>
      </div>
      <!-- /.container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/jquery.min.js.download"></script>
    <script src="./COMP 2211 Lab 8_ Convolutional Neural Networks_files/bootstrap.bundle.min.js.download"></script>	
  


</body></html>